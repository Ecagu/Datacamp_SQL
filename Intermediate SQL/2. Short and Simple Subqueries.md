# Filtering using scalar subqueries

### (1)
SELECT 
	3 * AVG(home_goal + away_goal)
FROM matches_2013_2014;

### (2)
SELECT 
    date,
	home_goal,
	away_goal
FROM  matches_2013_2014
WHERE (home_goal + away_goal) > 
       (SELECT 3 * AVG(home_goal + away_goal)
        FROM matches_2013_2014); 

# Filtering using a subquery with a list
SELECT 
	team_long_name,
	team_short_name
FROM team 
WHERE team_api_id NOT IN
     (SELECT DISTINCT hometeam_ID  FROM match);

# Filtering with more complex subquery conditions
SELECT
	team_long_name,
	team_short_name
FROM team
WHERE team_api_id IN
	  (SELECT hometeam_id 
       FROM match
       WHERE home_goal >= 8);

# Joining Subqueries in FROM

### (1)
SELECT 
	country_id, 
    id 
FROM match
WHERE (home_goal + away_goal) >= 10;

### (2)
SELECT
    c.name AS country_name,
    COUNT(sub.id) AS matches
FROM country AS c
INNER JOIN (SELECT country_id, id 
            FROM match
            WHERE (home_goal + away_goal) >= 10 ) AS sub
ON c.id = sub.country_id
GROUP BY country_name;